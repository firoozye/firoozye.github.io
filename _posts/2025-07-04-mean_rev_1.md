---
layout: post
title:  "Mean Reversion (Part 1)"
date:   2025-07-04 00:00:00 +0000
categories: jekyll update
---

# Mean Reversion (Part 1)

Mean reversion is one of the most important time-series features in finance. Most relative value trades require some form of mean-reversion. 
Most mid-frequency futures trading involve mean-reversion. Most market-making PnL is based on mean-reversion.

We all know what it is. And in fact, it is usually possible to identify mean-reverting series. The _eyeball test_ just works. 
If it crosses zero enough times, it probably mean-reverts. It can't wander. It can't drift off. It should find its way back down
again whenever it's up, or find its way back up again whenever it's down.

Eyeballs don't scale, though, so it is always handy to have a statistical test.

For mean-reversion there are a few in common use:

## The Augmented Dickey-Fuller Test (ADF Test)

The idea is if it mean reverts, the AR(1) coefficient will be negative, i.e., 

\\[ 
\Delta y_t = \beta y_{t-1} + \gamma_1 \Delta y_{t-1} + \gamma_2  \Delta y_{t-2} + \ldots \Delta y_{t-k}
\\]

The extra terms with \\(\gamma\\) are meant to model more complex time-series phenomena. The most important term is $\beta$ and we want to
ensure \\(\beta<0\\) (mean-reverting) vs \\(\beta=0\\) (non-stationary). 
Typically we would choose to use a t-test for testing whether a coefficient is non-zero.
But the typical t-distribution is meant to be the 
distribution of the t-test under the null-hypothesis. That works for regular regressions. 
But for time-series
under the null hypothesis, the t-test does not have a T-distribution. Rather it has what is known as a Dickey-Fuller Distribution. This is only characterised in the large-sample limit (i.e, as 
the time series sample size \\(T\rightarrow\infty\\) or by simulation). In large-sample the distribution is characterised by 

\\[
t_\rho = \frac{\hat{\beta}}{SE(\hat{\beta})} \Longrightrrrow
\frac{\int_0^1 W(t)dW(t)}{\bigl(\int W^2(t)dt\bigr)^{1/2}} 
\\]
This distribution is known as the Dickey-Fuller distribution, 
and it is a non-standard (and left-tailed) distribution,  typically tabulated in statistical packages.

The resulting test is known as the Augmented Dickey Fuller Test. It is known as a _unit-root test_ because the null-hypothesis $H_0: \beta=0$ corresponds to  a unit-root in the ARMA process, i.e.,

\\[
y_t = a_1  y_{t-1} +a_2 y_{t-2} + \cdots + a_k y_{t-k},
\\]

that one the roots of the characteristic polynomial is on the unit circle, similar to a Brownian motion.
 
In practice, since there are as many tests as there are lag-lengths $k$, automated ADF tests typically use a lag-length selection criterion, 
such as the Akaike Information Criterion (AIC) or the Bayesian Information Criterion (BIC), to select the lag-length $k$.
Only after the lag-length is selected, the ADF test is performed.

### References:
* [Augmented Dickey-Fuller Test](https://en.wikipedia.org/wiki/Augmented_Dickey%E2%80%93Fuller_test) is available in most statistical packages, including Python's `statsmodels` and R's `tseries` package.
* [Dickey, D. A., & Fuller, W. A. (1979). Distribution of the estimators for autoregressive time series with a unit root. Journal of the American Statistical Association, 74(366a), 427-431.](https://www.jstor.org/stable/2286348)
* [GS Madalla and I-M Kim (1998), Unit Roots, Cointegration, and Structural Change](https://www.amazon.com/Unit-Roots-Cointegration-Structural-Change/dp/0521629722) is a good reference for the ADF test, 
* unit roots and cointegration in general. A little dated, but still a good reference.


## Nyblom-Makala\"inen Test and KPSS test

The other standard test for mean-reversion is the Nyblom-Makala\"inen test, available in most stats packages in its more common and general form, the _KPSS test_. 

The standard version is based on a state-space model, 
\\[
\begin{eqnarray*}
y_t &= \mu_t + \epsilon_t\\
\mu_{t} &= \mu_{t-1} +\delta_t
\end{eqnarray*}
\\]
also known as the _local level model_, where \\(y_t\\) is the time series we are testing 
for mean-reversion, \\(\mu_t\\) is the time-varying mean, \\(\epsilon_t\\) is the noise in the series, 
and $\delta_t$ is the noise in the mean.

where typically we assume \\(\epsilon_t\sim \mathcal{N}(1,\sigma_\epsilon^2)\\) and \\(\delta_t\sim \mathcal{N}(0,\sigma_\delta^2)\\). 
We can see that $y$ has a unit root when $\sigma^2_\delta>0$. Consequently, the null-hypothesis for this mean-reversion test is that
\\[
H_0: \sigma^2_\delta>0.
\\] 
The Nyblom-M\"akal\"ainen test is a test for the null-hypothesis that the series is stationary, i.e., it does not have a unit root.
This test was originally proposed by Nyblom and Makalainen in 1983, and it is also known as the KPSS test, after Kwiatkowski, Phillips, Schmidt, and Shin who popularised it in 1992.

The test statistic is computed as follows: we estimate the state-space model, and then compute the residuals \\(\hat{\epsilon}_t\\) from the model.
Then we compute the test statistic as follows. Let $e(t)$ be the residuals from regressing $y_t$ on a constant.
We then compute the partial sums \\(S_t = \sum_{s=1}^t e(s)\\), and then the test statistic is given by
where $T$ is the sample size.
\\[
\text{KPSS} = \frac{1}{T^2} \sum_{t=1}^T \bigl(\sum_{s=1}^T \hat{\epsilon}_s\bigr)^2 / \sigma^2_\epsilon
\\]
where $\sigma^2_\epsilon$ is the variance of the residuals $\hat{\epsilon}_t$ (i.e., the standard single period estimator).

The KPSS test is a _stationarity test_ because the null-hypothesis $H_0: \sigma^2_\delta=0$ corresponds to the series being stationary, i.e., it does not have a unit root.o
The large-sample limit of the KPSS test statistic is known, as well as approximate critical values for the test statistic.

### References:
* [KPSS test](https://en.wikipedia.org/wiki/KPSS_test) is available in most statistical packages. 
* [Lo, A. W., & MacKinlay, A. C. (1988). Stock market prices do not follow random walks: Evidence from a simple specification test. The Review of Financial Studies, 1(1), 41-66.](https://www.jstor.org/stable/2961990)


## Mean-Reversion in Practice

Mean-reversion strategies are ubiquitous. However, due top the fact that mean-reversion is a fast phenomenon, 
transaction costs can be significant. 

In terms of a trading strategy, we can think of a mean-reversion strategy as follows.
1. Identify a mean-reverting series, e.g., using the ADF test or KPSS test.
2. Compute the variance ratio for the series, e.g., using the variance ratio test.
3. If the variance ratio is below a certain threshold, then we can consider the series to be mean-reverting, 
formulating a strategy where we buy when the spread or asset is 
trading below its mean, and short it when it is trading above its mean.

Typical weights may involve scaling into a long or a short linear relative to the distance from the mean,
or capping and flooring the weights to avoid excessive exposure. Also it is possible to just buy or sell a fixed number of units,
when the deviation meets a certain threshold.

Mean-reversion strategies can be applied to levels of a series, to spreads between two series, or to the residuals of a regression
between two series. In the latter case, the regression is typically a linear regression, but it can also be a more 
complex regression, such as a polynomial regression or a spline regression.

Mean-reversion is spreads is quite common in pairs trading and relative value trading. Examples could include:
1. Futures spreads, between two futures contracts on the same assset (e.g., a slope trade, which tends to mean revert to some typical slope).
2. Pairs trading where two stocks are correlated (e.g., FB and GOOG, or two oil companies, or two banks).
3. Spreads between three assets of fixed weights, e.g., a 1-2-1 butterfly in swaps or US Treasuries, which, over short time-periods tends to mean-revert to 
a constant 'fair-value' spread.


## Mean-Reversion in a Trading Framework:




## Further Discussions:
While mean-reversion (and the related concept of _Cointegration_, underpinning many pairs-trading and other stats-arb strategies)
is a particularly important time-series feature, most 


## References:

The overall trading framework is discussed in the introductory course, The Fundamentals of Algorithmic Trading, on the WBS Platform.

For a much more detailed discussion, the Algorithmic Trading Certificate, 
which is available on the WBS Platform, covers the topic in much more detail, 
including the statistical tests, the trading strategies, and the implementation details.
[Algorithmic Trading Certificate (ATC)](https://www.wbstraining.com/events/algorithmic-trading-certificate/)


Finally, I am working on a book on Algorithmic Trading, together with Dr Brian Healy, which will cover the topic in much more detail, including the statistical tests, 
the trading strategies, and the implementation in far more detail.

